const scriptURL="",form=document.forms["application-form"];let res;function successs(){$("#success").removeClass("d-none"),$("#wait").addClass("d-none"),200!==res.status&&($("#success").addClass("d-none"),$("#fail").removeClass("d-none"))}form.addEventListener("submit",e=>{e.preventDefault(),$("#submit-btn").addClass("d-none"),document.getElementById("wait").classList.remove("d-none"),fetch("",{method:"POST",body:new FormData(form)}).then(e=>{res=e,console.log("Success!",e)}).catch(e=>{console.error("Error!",e.message),$("#fail").removeClass("d-none"),$("#success").addClass("d-none")}),setTimeout(successs,5e3)});var apikey="";function readURL(e){if(e.files&&e.files[0]){var t=new FileReader;t.onload=function(e){$("#imageResult").attr("src",e.target.result)},t.readAsDataURL(e.files[0])}}$((function(){$("#upload").on("change",(function(){readURL(input),uploadimage("upload")}))}));var input=document.getElementById("upload"),infoArea=document.getElementById("upload-label"),urllink=document.getElementById("urllink");function showFileName(e){var t=e.srcElement.files[0].name;infoArea.textContent="File name: "+t}function uploadimage(e){var t=document.getElementById(e),n=new FormData;n.append("image",t.files[0]);var a={url:"https://api.imgbb.com/1/upload?key="+apikey,method:"POST",timeout:0,processData:!1,mimeType:"multipart/form-data",contentType:!1,data:n};$.ajax(a).done((function(e){console.log(e);var t=JSON.parse(e);console.log(t.data.url),urllink.innerHTML=t.data.url}))}input.addEventListener("change",showFileName),$(document).on("dragstart dragenter dragover",(function(e){$("#image-drag-drop").removeClass("d-none"),dropZoneVisible=!0})).on("drop dragleave dragend",(function(e){dropZoneTimer=setTimeout((function(){dropZoneVisible||$("#image-drag-drop").addClass("d-none")}),50),clearTimeout(dropZoneTimer)})),function(e,t,n,a){var o={exclude:".noExl",name:"Table2Excel",filename:"table2excel",fileext:".xlsx",exclude_img:!0,exclude_links:!0,exclude_inputs:!0,preserveColors:!1};function l(t,n){this.element=t,this.settings=e.extend({},o,n),this._defaults=o,this._name="table2excel",this.init()}function s(e){return e.filename?e.filename:"table2excel"}l.prototype={init:function(){var t=this;t.template={head:'<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><meta http-equiv="content-type" content="application/vnd.ms-excel; charset=UTF-8"><head>\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets>',sheet:{head:"<x:ExcelWorksheet><x:Name>",tail:"</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet>"},mid:"</x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e</head><body>",table:{head:"<table>",tail:"</table>"},foot:"</body></html>"},t.tableRows=[];var n="",a=null;e(t.element).each((function(o,l){var s,r="";e(l).find("tr").not(t.settings.exclude).each((function(o,l){n="",t.settings.preserveColors&&(a=getComputedStyle(l),n+=a&&a.backgroundColor?"background-color: "+a.backgroundColor+";":"",n+=a&&a.color?"color: "+a.color+";":""),r+="<tr style='"+n+"'>",e(l).find("td,th").not(t.settings.exclude).each((function(o,l){n="",t.settings.preserveColors&&(a=getComputedStyle(l),n+=a&&a.backgroundColor?"background-color: "+a.backgroundColor+";":"",n+=a&&a.color?"color: "+a.color+";":"");var s=e(this).attr("rowspan"),i=e(this).attr("colspan");e(l).find(t.settings.exclude).length>0?r+="<td> </td>":(r+="<td",s>0&&(r+=" rowspan='"+s+"' "),i>0&&(r+=" colspan='"+i+"' "),n&&(r+=" style='"+n+"'"),r+=">"+e(l).html()+"</td>")})),r+="</tr>"})),t.settings.exclude_img&&(s=/(\s+alt\s*=\s*"([^"]*)"|\s+alt\s*=\s*'([^']*)')/i,r=r.replace(/<img[^>]*>/gi,(function(e){var t=s.exec(e);return null!==t&&t.length>=2?t[2]:""}))),t.settings.exclude_links&&(r=function(e){return e.replace(/<a[^>]*>|<\/a>/gi,"")}(r)),t.settings.exclude_inputs&&(r=function(e){var t=/(\s+value\s*=\s*"([^"]*)"|\s+value\s*=\s*'([^']*)')/i;return e.replace(/<input[^>]*>|<\/input>/gi,(function(e){var n=t.exec(e);return null!==n&&n.length>=2?n[2]:""}))}(r)),t.tableRows.push(r)})),t.tableToExcel(t.tableRows,t.settings.name,t.settings.sheetName)},tableToExcel:function(a,o,l){var r,i,c,d=this,u="";for(r in d.format=function(e,t){return e.replace(/{(\w+)}/g,(function(e,n){return t[n]}))},l=void 0===l?"Sheet":l,d.ctx={worksheet:o||"Worksheet",table:a,sheetName:l},u=d.template.head,e.isArray(a)&&Object.keys(a).forEach((function(e){u+=d.template.sheet.head+l+e+d.template.sheet.tail})),u+=d.template.mid,e.isArray(a)&&Object.keys(a).forEach((function(e){u+=d.template.table.head+"{table"+e+"}"+d.template.table.tail})),u+=d.template.foot,a)d.ctx["table"+r]=a[r];if(delete d.ctx.table,-1!==navigator.appVersion.indexOf("MSIE 10")||-1!==navigator.userAgent.indexOf("Trident")&&-1!==navigator.userAgent.indexOf("rv:11"))if("undefined"!=typeof Blob){u=[u=d.format(u,d.ctx)];var m=new Blob(u,{type:"text/html"});t.navigator.msSaveBlob(m,s(d.settings))}else txtArea1.document.open("text/html","replace"),txtArea1.document.write(d.format(u,d.ctx)),txtArea1.document.close(),txtArea1.focus(),sa=txtArea1.document.execCommand("SaveAs",!0,s(d.settings));else{var f=new Blob([d.format(u,d.ctx)],{type:"application/vnd.ms-excel"});t.URL=t.URL||t.webkitURL,i=t.URL.createObjectURL(f),(c=n.createElement("a")).download=s(d.settings),c.href=i,n.body.appendChild(c),c.click(),n.body.removeChild(c)}return!0}},e.fn.table2excel=function(t){var n=this;return n.each((function(){e.data(n,"plugin_table2excel")||e.data(n,"plugin_table2excel",new l(this,t))})),n}}(jQuery,window,document),$((function(){$(".exportToExcel").click((function(e){var t=$(this).prev(".table2excel");if(t&&t.length){t.hasClass("table2excel_with_colors");$(t).table2excel({exclude:".noExl",name:"Excel Document Name",filename:"myFileName"+(new Date).toISOString().replace(/[\-\:\.]/g,"")+".xlsx",fileext:".xlsx"})}}))})),$(".datepicker").each((function(){new Pikaday({field:this})}));